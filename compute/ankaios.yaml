apiVersion: v0.1
workloads:
  databroker:
    runtime: podman
    agent: agent_compute
    runtimeConfig: |
      image: ghcr.io/eclipse-kuksa/kuksa-databroker:0.6.0
      commandArgs: ["--insecure"]
      commandOptions: ["--net=host"]
  mqtt:
    runtime: podman
    agent: agent_compute
    runtimeConfig: |
      image: docker.io/library/eclipse-mosquitto
      commandOptions: ["--net=host", "-v", "/home/chris/hackathon2025/ArBytesMoral/compute/mosquitto/config:/mosquitto/config"]
  mqtt2kuksa:
    runtime: podman
    dependencies:
      mqtt: ADD_COND_RUNNING
      databroker: ADD_COND_RUNNING
    agent: agent_compute
    runtimeConfig: |
      image: localhost/mqtt-kuksa-provider:latest
      commandOptions: ["--net=host"]
  vehilceDataAccessor:
    runtime: podman
    dependencies:
      databroker: ADD_COND_RUNNING
    agent: agent_compute
    runtimeConfig: |
      image: localhost/vehicle-data-accessor:latest
      commandOptions: ["--net=host"]
  carlaprovider:
    runtime: podman
    dependencies:
      databroker: ADD_COND_RUNNING
    agent: agent_compute
    runtimeConfig: |
      image: localhost/carla-provider:latest
      commandOptions: ["--net=host"]
  Ankaios_Dashboard:
    runtime: podman
    agent: agent_compute
    restart: true
    updateStrategy: AT_LEAST_ONCE
    accessRights:
      allow: []
      deny: []
    restartPolicy: NEVER 
    dependencies:
    runtimeConfig: |
       image: ghcr.io/eclipse-ankaios-dashboard/ankaios-dashboard:latest
       commandOptions: ["-p", "5001:5001"]
    controlInterfaceAccess:
        allowRules:
          - type: StateRule
            operation: ReadWrite
            filterMask:
              - "desiredState"
              - "workloadStates"
